<!doctype html>
<html>
<head>
<meta charset="UTF-8">
    <meta name="description" content="Instructions on how to do backups and restores for a SonicBase cluster">

    <title>SonicBase - Backup & Restore</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="../css/singlePageTemplate.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="../javascript/main.js"></script>
</head>
<body>
<div class="container">
    <header id="myHeader">
        <a href="../index.html">
            <h4 class="logo">SonicBaseâ„¢</h4>
        </a>
        <nav>
            <ul>
                <li><a href="../index.html">HOME</a></li>
                <li> <a href="../documentation.html">DOCUMENTATION</a></li>
                <li><a href="../contact.html">CONTACT</a></li>
            </ul>
        </nav>
    </header>

    <script>
        if (isFramed()) {
            document.getElementById("myHeader").style.display = "none";
        }
    </script>


    <div style="margin-left: 4em;">

<h1>Configuration</h1>
        <h2>FileSystem Backup</h2>
        The following configuration is used for a filesystem backup. The backup directory can
        be located on a a shared drive or be a local drive. If the directory is shared you must
        specify this with the "sharedDirectory" setting.<br/>
        {<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;"dataDirectory": "$HOME/db-data",<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;"installDirectory": "$HOME/database",<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;...<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;"backup": {<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"type": "fileSystem",<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"directory": "$HOME/db-backup",<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"sharedDirectory": true,<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"maxBackupCount": 10<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"cronSchedule": "0 0 * * *"<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;}<br/>
        }<br/>

        <h2>AWS Backup</h2>
        The following configuration is used for the AWS backup. Files will be backed up to S3 using
        the specified bucket and prefix.<br/>
        {<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;"dataDirectory": "$HOME/db-data",<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;"installDirectory": "$HOME/database",<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;...<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;"backup": {<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"type": "AWS",<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"bucket": "bucket-name",<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"prefix": "backups,<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"maxBackupCount": 10<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"cronSchedule": "0 0 * * *"<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;}<br/>
        }<br/>
        <br/>
        In order for AWS integration to work you must have a file named "&lt;cluster&gt;-awskeys" located in the
        "keys" subdirectory of the install directory.

        <br/>
        <h2>maxBackupCount</h2>
        The maxBackupCount setting allows you to specify how many backups you want to keep. The most recent n backups
        are kept after doing a backup.
        <h2>cronSchedule</h2>
        <div class="mylink">
        The cronSchedule setting allows you to specify when the backup starts. Specify a valid cron expression. To learn
        more about cron visit <a href="https://en.wikipedia.org/wiki/Cron">Wikipedia</a> or
        <a href="http://www.quartz-scheduler.org">Quartz</a>. If you don't specify a cronSchedule you may manually
        start a backup in the administration client by typing "start backup".
        </div>

        <h1>Restore</h1>
        To restore a backup, in the administration client type "start restore &lt;backupDir&gt;". Where "backupDir" is
        the name of the backup directory to restore. If the following is your actual direcotry:<br/>
        <br/>
        &nbsp;&nbsp;&nbsp;&nbsp;/mnt/db-backups/2017-06-17T20:52:10.000Z<br/>
        <br/>
        Then you would specify "2017-06-17T20:52:10.000Z" as the directory to restore.
</div>
</div>
</body>
</html>
